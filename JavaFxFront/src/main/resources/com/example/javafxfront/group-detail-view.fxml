<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<BorderPane xmlns="http://javafx.com/javafx/11.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.example.javafxfront.GroupDetailController">
    <top>
        <!-- Header with group info -->
        <VBox styleClass="group-header">
            <padding>
                <Insets bottom="20.0" left="30.0" right="30.0" top="20.0" />
            </padding>

            <HBox alignment="CENTER_LEFT" spacing="20.0">
                <VBox spacing="5.0">
                    <Label fx:id="groupNameLabel" styleClass="group-header-name" text="Nazwa Grupy">
                        <font>
                            <Font name="System Bold" size="24.0" />
                        </font>
                    </Label>
                    <Label fx:id="groupSpecializationLabel" styleClass="group-header-spec" text="Specjalizacja">
                        <font>
                            <Font size="16.0" />
                        </font>
                    </Label>
                </VBox>

                <Region HBox.hgrow="ALWAYS" />

                <VBox alignment="CENTER_RIGHT" spacing="5.0">
                    <Label fx:id="studentCountLabel" styleClass="count-badge" text="Liczba studentów: 0">
                        <font>
                            <Font size="12.0" />
                        </font>
                    </Label>
                    <Label fx:id="scheduleCountLabel" styleClass="count-badge" text="Liczba terminów: 0">
                        <font>
                            <Font size="12.0" />
                        </font>
                    </Label>
                </VBox>

                <Button fx:id="showReportButton" mnemonicParsing="false" onAction="#onShowReportClick"
                        styleClass="primary-button" text="📊 Dziennik obecności" />

                <Button fx:id="backButton" mnemonicParsing="false" onAction="#onBackClick"
                        styleClass="secondary-button" text="← Powrót" />
            </HBox>
        </VBox>
    </top>

    <center>
        <ScrollPane fitToWidth="true" fitToHeight="true" styleClass="scroll-pane">
            <VBox spacing="20.0" styleClass="detail-container">
                <padding>
                    <Insets bottom="30.0" left="30.0" right="30.0" top="10.0" />
                </padding>

                <!-- Main content with tabs -->
                <TabPane styleClass="main-tabs" tabClosingPolicy="UNAVAILABLE">

                    <!-- Students Tab -->
                    <Tab text="Studenci">
                        <HBox spacing="20.0" alignment="TOP_CENTER">

                            <!-- Add Student Form -->
                            <VBox spacing="15.0" styleClass="form-card" maxWidth="350.0" minWidth="300.0">
                                <padding>
                                    <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
                                </padding>

                                <Label styleClass="form-title" text="Dodaj studenta">
                                    <font>
                                        <Font name="System Bold" size="16.0" />
                                    </font>
                                </Label>

                                <VBox spacing="10.0">
                                    <VBox spacing="5.0">
                                        <Label styleClass="field-label" text="Imię:" />
                                        <TextField fx:id="firstNameField" promptText="Imię studenta (opcjonalne)" styleClass="modern-field" />
                                    </VBox>

                                    <VBox spacing="5.0">
                                        <Label styleClass="field-label" text="Nazwisko:" />
                                        <TextField fx:id="lastNameField" promptText="Nazwisko studenta (opcjonalne)" styleClass="modern-field" />
                                    </VBox>

                                    <VBox spacing="5.0">
                                        <Label styleClass="field-label" text="Nr indeksu:" />
                                        <TextField fx:id="indexNumberField" promptText="6 cyfr (np. 123456)"
                                                   styleClass="modern-field" />
                                    </VBox>
                                </VBox>

                                <!-- ULEPSZONA INSTRUKCJA -->
                                <VBox spacing="8.0" styleClass="info-note" style="-fx-background-color: rgba(220, 20, 60, 0.08); -fx-border-color: rgba(220, 20, 60, 0.3); -fx-border-width: 1; -fx-border-radius: 8; -fx-background-radius: 8;">
                                    <Label text="📋 INSTRUKCJA DODAWANIA:" style="-fx-font-weight: bold; -fx-font-size: 11px; -fx-text-fill: #DC143C;">
                                        <font>
                                            <Font name="System Bold" size="11.0" />
                                        </font>
                                    </Label>

                                    <Label text="🔸 PRZYPISZ ISTNIEJĄCEGO:" style="-fx-font-size: 10px; -fx-font-weight: bold; -fx-text-fill: #38A169;">
                                        <font>
                                            <Font size="10.0" />
                                        </font>
                                    </Label>
                                    <Label text="   Wpisz tylko Nr indeksu (pozostaw puste Imię i Nazwisko)" style="-fx-font-size: 9px; -fx-text-fill: #495057;">
                                        <font>
                                            <Font size="9.0" />
                                        </font>
                                    </Label>

                                    <Label text="🔸 UTWÓRZ NOWEGO:" style="-fx-font-size: 10px; -fx-font-weight: bold; -fx-text-fill: #F56500;">
                                        <font>
                                            <Font size="10.0" />
                                        </font>
                                    </Label>
                                    <Label text="   Wypełnij wszystkie pola: Imię + Nazwisko + Nr indeksu" style="-fx-font-size: 9px; -fx-text-fill: #495057;">
                                        <font>
                                            <Font size="9.0" />
                                        </font>
                                    </Label>

                                    <Label text="⚠️ Niepełne dane spowodują błąd walidacji" style="-fx-font-size: 9px; -fx-text-fill: #E53E3E; -fx-font-style: italic;">
                                        <font>
                                            <Font size="9.0" />
                                        </font>
                                    </Label>
                                </VBox>

                                <Button fx:id="addStudentButton" mnemonicParsing="false" onAction="#onAddStudentClick"
                                        styleClass="primary-button" text="Dodaj studenta" maxWidth="Infinity" />

                                <!-- Server operations -->
                                <Separator />
                                <Label styleClass="field-label" text="Operacje serwerowe:" />

                                <Button fx:id="loadStudentsButton" mnemonicParsing="false" onAction="#onLoadStudentsClick"
                                        styleClass="secondary-button" text="Załaduj studentów bez grupy" maxWidth="Infinity" />

                                <Label styleClass="info-note" text="Automatycznie załaduj wszystkich studentów bez przypisanej grupy z serwera">
                                    <font>
                                        <Font size="10.0" />
                                    </font>
                                </Label>
                            </VBox>

                            <!-- Students List -->
                            <VBox spacing="15.0" styleClass="list-card" VBox.vgrow="ALWAYS" minWidth="400.0">
                                <padding>
                                    <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
                                </padding>

                                <HBox alignment="CENTER_LEFT" spacing="10.0">
                                    <Label styleClass="form-title" text="Lista studentów">
                                        <font>
                                            <Font name="System Bold" size="16.0" />
                                        </font>
                                    </Label>
                                    <Region HBox.hgrow="ALWAYS" />
                                    <Button fx:id="refreshStudentsButton" mnemonicParsing="false" onAction="#onRefreshStudentsClick"
                                            styleClass="secondary-button" text="🔄 Odśwież z serwera" />
                                </HBox>

                                <!-- Informacja o statusie studentów -->
                                <HBox spacing="10.0" alignment="CENTER_LEFT" style="-fx-background-color: rgba(248, 249, 250, 0.8); -fx-padding: 8; -fx-background-radius: 5;">
                                    <Label text="💡" style="-fx-font-size: 12px;" />
                                    <Label text="Lista pokazuje wszystkich studentów przypisanych do tej grupy"
                                           style="-fx-font-size: 10px; -fx-text-fill: #6C757D;">
                                        <font>
                                            <Font size="10.0" />
                                        </font>
                                    </Label>
                                </HBox>

                                <ListView fx:id="studentsListView" styleClass="modern-list"
                                          VBox.vgrow="ALWAYS" minHeight="300.0" maxHeight="400.0" />

                                <HBox alignment="CENTER" spacing="10.0">
                                    <Button fx:id="removeStudentButton" mnemonicParsing="false" onAction="#onRemoveStudentClick"
                                            styleClass="danger-button" text="Usuń studenta z grupy" />
                                </HBox>
                            </VBox>
                        </HBox>
                    </Tab>

                    <!-- Terminy Tab -->
                    <Tab text="Terminy i Frekwencja">
                        <HBox spacing="20.0" alignment="TOP_CENTER">

                            <!-- Add Termin Form -->
                            <VBox spacing="15.0" styleClass="form-card" maxWidth="350.0" minWidth="300.0">
                                <padding>
                                    <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
                                </padding>

                                <Label styleClass="form-title" text="Dodaj termin">
                                    <font>
                                        <Font name="System Bold" size="16.0" />
                                    </font>
                                </Label>

                                <VBox spacing="10.0">
                                    <VBox spacing="5.0">
                                        <Label styleClass="field-label" text="Nazwa terminu:" />
                                        <TextField fx:id="terminNameField" promptText="np. Egzamin z Javy" styleClass="modern-field" />
                                    </VBox>

                                    <VBox spacing="5.0">
                                        <Label styleClass="field-label" text="Data:" />
                                        <DatePicker fx:id="terminDatePicker" promptText="Wybierz datę" styleClass="modern-date-picker" />
                                    </VBox>

                                    <VBox spacing="5.0">
                                        <Label styleClass="field-label" text="Godzina rozpoczęcia:" />
                                        <TextField fx:id="terminStartTimeField" promptText="HH:MM (np. 10:15)" styleClass="modern-field" />
                                    </VBox>

                                    <VBox spacing="5.0">
                                        <Label styleClass="field-label" text="Godzina zakończenia:" />
                                        <TextField fx:id="terminEndTimeField" promptText="HH:MM (np. 12:00)" styleClass="modern-field" />
                                    </VBox>

                                    <!-- Informacja o grupie -->
                                    <VBox spacing="5.0" styleClass="group-info-box">
                                        <Label styleClass="field-label" text="Grupa:" />
                                        <Label fx:id="terminGroupLabel" styleClass="assigned-group-label" text="[Nazwa grupy]" />
                                    </VBox>
                                </VBox>

                                <Button fx:id="addTerminButton" mnemonicParsing="false" onAction="#onAddTerminClick"
                                        styleClass="primary-button" text="Dodaj termin" maxWidth="Infinity" />

                                <!-- Informacja o frekwencji -->
                                <Separator />
                                <VBox spacing="5.0" styleClass="info-note">
                                    <Label text="📊 ZARZĄDZANIE FREKWENCJĄ:" style="-fx-font-weight: bold; -fx-font-size: 11px;">
                                        <font>
                                            <Font size="11.0" />
                                        </font>
                                    </Label>
                                    <Label text="Po utworzeniu terminu kliknij na niego w liście aby oznaczyć obecność studentów" style="-fx-font-size: 10px;">
                                        <font>
                                            <Font size="10.0" />
                                        </font>
                                    </Label>
                                </VBox>
                            </VBox>

                            <!-- Terminy List -->
                            <VBox spacing="15.0" styleClass="list-card" VBox.vgrow="ALWAYS" minWidth="450.0">
                                <padding>
                                    <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
                                </padding>

                                <HBox alignment="CENTER_LEFT" spacing="10.0">
                                    <Label styleClass="form-title" text="Lista terminów">
                                        <font>
                                            <Font name="System Bold" size="16.0" />
                                        </font>
                                    </Label>
                                    <Region HBox.hgrow="ALWAYS" />
                                    <Button fx:id="refreshSchedulesButton" mnemonicParsing="false" onAction="#onRefreshSchedulesClick"
                                            styleClass="secondary-button" text="🔄 Odśwież z serwera" />
                                </HBox>

                                <!-- Legenda i instrukcje -->
                                <VBox spacing="8.0" styleClass="info-note" style="-fx-background-color: rgba(220, 20, 60, 0.05); -fx-border-color: rgba(220, 20, 60, 0.2); -fx-border-width: 1; -fx-border-radius: 8; -fx-background-radius: 8;">
                                    <Label text="📋 INSTRUKCJA TERMINÓW:" style="-fx-font-weight: bold; -fx-font-size: 11px; -fx-text-fill: #DC143C;">
                                        <font>
                                            <Font size="11.0" />
                                        </font>
                                    </Label>
                                    <Label text="• Kliknij na termin aby zarządzać frekwencją studentów" style="-fx-font-size: 10px;" />
                                    <Label text="• Możesz oznaczać studentów jako: Obecny, Spóźniony, Nieobecny" style="-fx-font-size: 10px;" />
                                    <Label text="• Kolory statusów terminów:" style="-fx-font-size: 10px; -fx-font-weight: bold;" />

                                    <HBox spacing="15.0" style="-fx-padding: 3 0 0 10;">
                                        <Label text="🟢 Obecny" style="-fx-text-fill: #38A169; -fx-font-size: 10px; -fx-font-weight: bold;" />
                                        <Label text="🟠 Spóźniony" style="-fx-text-fill: #F56500; -fx-font-size: 10px; -fx-font-weight: bold;" />
                                        <Label text="🔴 Nieobecny" style="-fx-text-fill: #E53E3E; -fx-font-size: 10px; -fx-font-weight: bold;" />
                                    </HBox>

                                    <HBox spacing="15.0" style="-fx-padding: 3 0 0 10;">
                                        <Label text="🔵 Serwer" style="-fx-text-fill: #38A169; -fx-font-size: 10px; -fx-font-weight: bold;" />
                                        <Label text="🔴 Lokalny" style="-fx-text-fill: #E53E3E; -fx-font-size: 10px; -fx-font-weight: bold;" />
                                    </HBox>
                                </VBox>

                                <ListView fx:id="scheduleListView" styleClass="modern-list"
                                          VBox.vgrow="ALWAYS" minHeight="300.0" maxHeight="400.0" />

                                <HBox alignment="CENTER" spacing="10.0">
                                    <Button fx:id="removeScheduleButton" mnemonicParsing="false" onAction="#onRemoveScheduleClick"
                                            styleClass="danger-button" text="Usuń termin" />
                                </HBox>

                                <!-- Ostrzeżenie -->
                                <VBox spacing="5.0" styleClass="info-note" style="-fx-background-color: rgba(229, 62, 62, 0.05); -fx-border-color: rgba(229, 62, 62, 0.2); -fx-border-width: 1; -fx-border-radius: 5; -fx-background-radius: 5;">
                                    <Label text="⚠️ UWAGA:" style="-fx-font-weight: bold; -fx-font-size: 10px; -fx-text-fill: #E53E3E;">
                                        <font>
                                            <Font size="10.0" />
                                        </font>
                                    </Label>
                                    <Label text="Usuwanie terminów spowoduje utratę wszystkich danych o frekwencji dla tego terminu." style="-fx-font-size: 9px; -fx-text-fill: #E53E3E;">
                                        <font>
                                            <Font size="9.0" />
                                        </font>
                                    </Label>
                                </VBox>
                            </VBox>
                        </HBox>
                    </Tab>
                </TabPane>
            </VBox>
        </ScrollPane>
    </center>
</BorderPane>